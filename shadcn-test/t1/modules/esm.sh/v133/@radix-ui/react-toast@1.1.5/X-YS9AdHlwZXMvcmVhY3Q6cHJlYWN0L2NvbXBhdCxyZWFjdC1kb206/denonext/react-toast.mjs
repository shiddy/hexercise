import*as e from"../../../../../../esm.sh/preact@10.19.6/compat.js";
import*as ve from"../../../../../../esm.sh/preact@10.19.6/compat.js";
import{composeEventHandlers as R}from"../../../../../../esm.sh/_@radix-ui/primitive@1.0.1.js";
import{useComposedRefs as re}from"../../../../../../esm.sh/v132/_@radix-ui/react-compose-refs@1.0.1.js";
import{createCollection as ye}from"../../../../../../esm.sh/v132/_@radix-ui/react-collection@1.0.3.js";
import{createContextScope as Pe}from"../../../../../../esm.sh/v132/_@radix-ui/react-context@1.0.1.js";
import*as ae from"../../../../../../esm.sh/v132/_@radix-ui/react-dismissable-layer@1.0.5.js";
import{Portal as Ce}from"../../../../../../esm.sh/v132/_@radix-ui/react-portal@1.0.4.js";
import{Presence as Re}from"../../../../../../esm.sh/v132/_@radix-ui/react-presence@1.0.1.js";
import{Primitive as D,dispatchDiscreteCustomEvent as xe}from"../../../../../../esm.sh/v132/_@radix-ui/react-primitive@1.0.3.js";
import{useCallbackRef as V}from"../../../../../../esm.sh/v132/_@radix-ui/react-use-callback-ref@1.0.1.js";
import{useControllableState as be}from"../../../../../../esm.sh/v132/_@radix-ui/react-use-controllable-state@1.0.1.js";
import{useLayoutEffect as he}from"../../../../../../esm.sh/v132/_@radix-ui/react-use-layout-effect@1.0.1.js";
import{VisuallyHidden as ie}from"../../../../../../esm.sh/v132/_@radix-ui/react-visually-hidden@1.0.3.js";
const $="ToastProvider",[B,ge,Se]=ye("Toast"),[ce,De]=Pe("Toast",[Se]),[Fe,H]=ce($),q=t=>{const{__scopeToast:n,label:s="Notification",duration:o=5e3,swipeDirection:c="right",swipeThreshold:l=50,children:d}=t,[m,E]=e.useState(null),[i,C]=e.useState(0),w=e.useRef(!1),F=e.useRef(!1);return s.trim()||console.error(`Invalid prop \`label\` supplied to \`${$}\`. Expected non-empty \`string\`.`),e.createElement(B.Provider,{scope:n},e.createElement(Fe,{scope:n,label:s,duration:o,swipeDirection:c,swipeThreshold:l,toastCount:i,viewport:m,onViewportChange:E,onToastAdd:e.useCallback(()=>C(h=>h+1),[]),onToastRemove:e.useCallback(()=>C(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:w,isClosePausedRef:F},d))};q.displayName=$;const ue="ToastViewport",Ie=["F8"],j="toast.viewportPause",z="toast.viewportResume",G=e.forwardRef((t,n)=>{const{__scopeToast:s,hotkey:o=Ie,label:c="Notifications ({hotkey})",...l}=t,d=H(ue,s),m=ge(s),E=e.useRef(null),i=e.useRef(null),C=e.useRef(null),w=e.useRef(null),F=re(n,w,d.onViewportChange),h=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=d.toastCount>0;e.useEffect(()=>{const a=v=>{o.every(f=>v[f]||v.code===f)&&w.current?.focus()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[o]),e.useEffect(()=>{const a=E.current,v=w.current;if(g&&a&&v){const p=()=>{if(!d.isClosePausedRef.current){const T=new CustomEvent(j);v.dispatchEvent(T),d.isClosePausedRef.current=!0}},f=()=>{if(d.isClosePausedRef.current){const T=new CustomEvent(z);v.dispatchEvent(T),d.isClosePausedRef.current=!1}},y=T=>{!a.contains(T.relatedTarget)&&f()},P=()=>{a.contains(document.activeElement)||f()};return a.addEventListener("focusin",p),a.addEventListener("focusout",y),a.addEventListener("pointermove",p),a.addEventListener("pointerleave",P),window.addEventListener("blur",p),window.addEventListener("focus",f),()=>{a.removeEventListener("focusin",p),a.removeEventListener("focusout",y),a.removeEventListener("pointermove",p),a.removeEventListener("pointerleave",P),window.removeEventListener("blur",p),window.removeEventListener("focus",f)}}},[g,d.isClosePausedRef]);const u=e.useCallback(({tabbingDirection:a})=>{const p=m().map(f=>{const y=f.ref.current,P=[y,...Xe(y)];return a==="forwards"?P:P.reverse()});return(a==="forwards"?p.reverse():p).flat()},[m]);return e.useEffect(()=>{const a=w.current;if(a){const v=p=>{const f=p.altKey||p.ctrlKey||p.metaKey;if(p.key==="Tab"&&!f){const P=document.activeElement,T=p.shiftKey;if(p.target===a&&T){i.current?.focus();return}const _=u({tabbingDirection:T?"backwards":"forwards"}),M=_.findIndex(S=>S===P);oe(_.slice(M+1))?p.preventDefault():T?i.current?.focus():C.current?.focus()}};return a.addEventListener("keydown",v),()=>a.removeEventListener("keydown",v)}},[m,u]),e.createElement(ae.Branch,{ref:E,role:"region","aria-label":c.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:g?void 0:"none"}},g&&e.createElement(J,{ref:i,onFocusFromOutsideViewport:()=>{const a=u({tabbingDirection:"forwards"});oe(a)}}),e.createElement(B.Slot,{scope:s},e.createElement(D.ol,{tabIndex:-1,...l,ref:F})),g&&e.createElement(J,{ref:C,onFocusFromOutsideViewport:()=>{const a=u({tabbingDirection:"backwards"});oe(a)}}))});G.displayName=ue;const le="ToastFocusProxy",J=e.forwardRef((t,n)=>{const{__scopeToast:s,onFocusFromOutsideViewport:o,...c}=t,l=H(le,s);return e.createElement(ie,{"aria-hidden":!0,tabIndex:0,...c,ref:n,style:{position:"fixed"},onFocus:d=>{const m=d.relatedTarget;!l.viewport?.contains(m)&&o()}})});J.displayName=le;const W="Toast",_e="toast.swipeStart",Ae="toast.swipeMove",Ne="toast.swipeCancel",Le="toast.swipeEnd",Q=e.forwardRef((t,n)=>{const{forceMount:s,open:o,defaultOpen:c,onOpenChange:l,...d}=t,[m=!0,E]=be({prop:o,defaultProp:c,onChange:l});return e.createElement(Re,{present:s||m},e.createElement(ke,{open:m,...d,ref:n,onClose:()=>E(!1),onPause:V(t.onPause),onResume:V(t.onResume),onSwipeStart:R(t.onSwipeStart,i=>{i.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:R(t.onSwipeMove,i=>{const{x:C,y:w}=i.detail.delta;i.currentTarget.setAttribute("data-swipe","move"),i.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${C}px`),i.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${w}px`)}),onSwipeCancel:R(t.onSwipeCancel,i=>{i.currentTarget.setAttribute("data-swipe","cancel"),i.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),i.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),i.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),i.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:R(t.onSwipeEnd,i=>{const{x:C,y:w}=i.detail.delta;i.currentTarget.setAttribute("data-swipe","end"),i.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),i.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),i.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${C}px`),i.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${w}px`),E(!1)})}))});Q.displayName=W;const[Me,Oe]=ce(W,{onClose(){}}),ke=e.forwardRef((t,n)=>{const{__scopeToast:s,type:o="foreground",duration:c,open:l,onClose:d,onEscapeKeyDown:m,onPause:E,onResume:i,onSwipeStart:C,onSwipeMove:w,onSwipeCancel:F,onSwipeEnd:h,...g}=t,u=H(W,s),[a,v]=e.useState(null),p=re(n,r=>v(r)),f=e.useRef(null),y=e.useRef(null),P=c||u.duration,T=e.useRef(0),I=e.useRef(P),L=e.useRef(0),{onToastAdd:_,onToastRemove:M}=u,S=V(()=>{a?.contains(document.activeElement)&&u.viewport?.focus(),d()}),O=e.useCallback(r=>{!r||r===1/0||(window.clearTimeout(L.current),T.current=new Date().getTime(),L.current=window.setTimeout(S,r))},[S]);e.useEffect(()=>{const r=u.viewport;if(r){const x=()=>{O(I.current),i?.()},b=()=>{const A=new Date().getTime()-T.current;I.current=I.current-A,window.clearTimeout(L.current),E?.()};return r.addEventListener(j,b),r.addEventListener(z,x),()=>{r.removeEventListener(j,b),r.removeEventListener(z,x)}}},[u.viewport,P,E,i,O]),e.useEffect(()=>{l&&!u.isClosePausedRef.current&&O(P)},[l,P,u.isClosePausedRef,O]),e.useEffect(()=>(_(),()=>{u.isClosePausedRef.current=!1,M()}),[_,M]);const ne=e.useMemo(()=>a?me(a):null,[a]);return u.viewport?e.createElement(e.Fragment,null,ne&&e.createElement(Ke,{__scopeToast:s,role:"status","aria-live":o==="foreground"?"assertive":"polite","aria-atomic":!0},ne),e.createElement(Me,{scope:s,onClose:S},ve.createPortal(e.createElement(B.ItemSlot,{scope:s},e.createElement(ae.Root,{asChild:!0,onEscapeKeyDown:R(m,()=>{u.isFocusedToastEscapeKeyDownRef.current||S(),u.isFocusedToastEscapeKeyDownRef.current=!1})},e.createElement(D.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":u.swipeDirection,...g,ref:p,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:R(t.onKeyDown,r=>{r.key==="Escape"&&(m?.(r.nativeEvent),r.nativeEvent.defaultPrevented||(u.isFocusedToastEscapeKeyDownRef.current=!0,S()))}),onPointerDown:R(t.onPointerDown,r=>{r.button===0&&(f.current={x:r.clientX,y:r.clientY})}),onPointerMove:R(t.onPointerMove,r=>{if(!f.current)return;const x=r.clientX-f.current.x,b=r.clientY-f.current.y,A=!!y.current,N=["left","right"].includes(u.swipeDirection),k=["left","up"].includes(u.swipeDirection)?Math.min:Math.max,Te=N?k(0,x):0,we=N?0:k(0,b),Y=r.pointerType==="touch"?10:2,K={x:Te,y:we},se={originalEvent:r,delta:K};A?(y.current=K,X(Ae,w,se,{discrete:!1})):Ee(K,u.swipeDirection,Y)?(y.current=K,X(_e,C,se,{discrete:!1}),r.target.setPointerCapture(r.pointerId)):(Math.abs(x)>Y||Math.abs(b)>Y)&&(f.current=null)}),onPointerUp:R(t.onPointerUp,r=>{const x=y.current,b=r.target;if(b.hasPointerCapture(r.pointerId)&&b.releasePointerCapture(r.pointerId),y.current=null,f.current=null,x){const A=r.currentTarget,N={originalEvent:r,delta:x};Ee(x,u.swipeDirection,u.swipeThreshold)?X(Le,h,N,{discrete:!0}):X(Ne,F,N,{discrete:!0}),A.addEventListener("click",k=>k.preventDefault(),{once:!0})}})}))),u.viewport))):null}),Ke=t=>{const{__scopeToast:n,children:s,...o}=t,c=H(W,n),[l,d]=e.useState(!1),[m,E]=e.useState(!1);return We(()=>d(!0)),e.useEffect(()=>{const i=window.setTimeout(()=>E(!0),1e3);return()=>window.clearTimeout(i)},[]),m?null:e.createElement(Ce,{asChild:!0},e.createElement(ie,o,l&&e.createElement(e.Fragment,null,c.label," ",s)))},Ve="ToastTitle",Z=e.forwardRef((t,n)=>{const{__scopeToast:s,...o}=t;return e.createElement(D.div,{...o,ref:n})});Z.displayName=Ve;const He="ToastDescription",ee=e.forwardRef((t,n)=>{const{__scopeToast:s,...o}=t;return e.createElement(D.div,{...o,ref:n})});ee.displayName=He;const de="ToastAction",te=e.forwardRef((t,n)=>{const{altText:s,...o}=t;return s.trim()?e.createElement(fe,{altText:s,asChild:!0},e.createElement(U,{...o,ref:n})):(console.error(`Invalid prop \`altText\` supplied to \`${de}\`. Expected non-empty \`string\`.`),null)});te.displayName=de;const pe="ToastClose",U=e.forwardRef((t,n)=>{const{__scopeToast:s,...o}=t,c=Oe(pe,s);return e.createElement(fe,{asChild:!0},e.createElement(D.button,{type:"button",...o,ref:n,onClick:R(t.onClick,c.onClose)}))});U.displayName=pe;const fe=e.forwardRef((t,n)=>{const{__scopeToast:s,altText:o,...c}=t;return e.createElement(D.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":o||void 0,...c,ref:n})});function me(t){const n=[];return Array.from(t.childNodes).forEach(o=>{if(o.nodeType===o.TEXT_NODE&&o.textContent&&n.push(o.textContent),Ue(o)){const c=o.ariaHidden||o.hidden||o.style.display==="none",l=o.dataset.radixToastAnnounceExclude==="";if(!c)if(l){const d=o.dataset.radixToastAnnounceAlt;d&&n.push(d)}else n.push(...me(o))}}),n}function X(t,n,s,{discrete:o}){const c=s.originalEvent.currentTarget,l=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:s});n&&c.addEventListener(t,n,{once:!0}),o?xe(c,l):c.dispatchEvent(l)}const Ee=(t,n,s=0)=>{const o=Math.abs(t.x),c=Math.abs(t.y),l=o>c;return n==="left"||n==="right"?l&&o>s:!l&&c>s};function We(t=()=>{}){const n=V(t);he(()=>{let s=0,o=0;return s=window.requestAnimationFrame(()=>o=window.requestAnimationFrame(n)),()=>{window.cancelAnimationFrame(s),window.cancelAnimationFrame(o)}},[n])}function Ue(t){return t.nodeType===t.ELEMENT_NODE}function Xe(t){const n=[],s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const c=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||c?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)n.push(s.currentNode);return n}function oe(t){const n=document.activeElement;return t.some(s=>s===n?!0:(s.focus(),document.activeElement!==n))}const Ye=q,$e=G,Be=Q,qe=Z,je=ee,ze=te,Ge=U;export{De as createToastScope,q as ToastProvider,G as ToastViewport,Q as Toast,Z as ToastTitle,ee as ToastDescription,te as ToastAction,U as ToastClose,Ye as Provider,$e as Viewport,Be as Root,qe as Title,je as Description,ze as Action,Ge as Close};
