/* esm.sh - esbuild bundle(@radix-ui/react-roving-focus@1.0.4) denonext production */
import _ from"../../../../../../esm.sh/@babel/runtime@7.23.1/helpers/esm/extends.js";
import{forwardRef as A,createElement as i,useRef as G,useState as P,useEffect as O,useCallback as I}from"../../../../../../esm.sh/preact@10.19.6/compat.js";
import{composeEventHandlers as l}from"../../../../../../esm.sh/_@radix-ui/primitive@1.0.1.js";
import{createCollection as j}from"../../../../../../esm.sh/v132/_@radix-ui/react-collection@1.0.3.js";
import{useComposedRefs as V}from"../../../../../../esm.sh/v132/_@radix-ui/react-compose-refs@1.0.1.js";
import{createContextScope as z}from"../../../../../../esm.sh/v132/_@radix-ui/react-context@1.0.1.js";
import{useId as q}from"../../../../../../esm.sh/v132/_@radix-ui/react-id@1.0.1.js";
import{Primitive as N}from"../../../../../../esm.sh/v132/_@radix-ui/react-primitive@1.0.3.js";
import{useCallbackRef as J}from"../../../../../../esm.sh/v132/_@radix-ui/react-use-callback-ref@1.0.1.js";
import{useControllableState as Q}from"../../../../../../esm.sh/v132/_@radix-ui/react-use-controllable-state@1.0.1.js";
import{useDirection as W}from"../../../../../../esm.sh/v132/_@radix-ui/react-direction@1.0.1.js";
var T="rovingFocusGroup.onEntryFocus",X={bubbles:!1,cancelable:!0},x="RovingFocusGroup",[w,M,Z]=j(x),[ee,Ee]=z(x,[Z]),[oe,te]=ee(x),re=A((e,o)=>i(w.Provider,{scope:e.__scopeRovingFocusGroup},i(w.Slot,{scope:e.__scopeRovingFocusGroup},i(ne,_({},e,{ref:o}))))),ne=A((e,o)=>{let{__scopeRovingFocusGroup:n,orientation:t,loop:v=!1,dir:F,currentTabStopId:g,defaultCurrentTabStopId:R,onCurrentTabStopIdChange:b,onEntryFocus:c,...C}=e,$=G(null),m=V(o,$),p=W(F),[s=null,u]=Q({prop:g,defaultProp:R,onChange:b}),[E,a]=P(!1),f=J(c),U=M(n),S=G(!1),[k,h]=P(0);return O(()=>{let r=$.current;if(r)return r.addEventListener(T,f),()=>r.removeEventListener(T,f)},[f]),i(oe,{scope:n,orientation:t,dir:p,loop:v,currentTabStopId:s,onItemFocus:I(r=>u(r),[u]),onItemShiftTab:I(()=>a(!0),[]),onFocusableItemAdd:I(()=>h(r=>r+1),[]),onFocusableItemRemove:I(()=>h(r=>r-1),[])},i(N.div,_({tabIndex:E||k===0?-1:0,"data-orientation":t},C,{ref:m,style:{outline:"none",...e.style},onMouseDown:l(e.onMouseDown,()=>{S.current=!0}),onFocus:l(e.onFocus,r=>{let K=!S.current;if(r.target===r.currentTarget&&K&&!E){let D=new CustomEvent(T,X);if(r.currentTarget.dispatchEvent(D),!D.defaultPrevented){let y=U().filter(d=>d.focusable),B=y.find(d=>d.active),H=y.find(d=>d.id===s),Y=[B,H,...y].filter(Boolean).map(d=>d.ref.current);L(Y)}}S.current=!1}),onBlur:l(e.onBlur,()=>a(!1))})))}),se="RovingFocusGroupItem",ce=A((e,o)=>{let{__scopeRovingFocusGroup:n,focusable:t=!0,active:v=!1,tabStopId:F,...g}=e,R=q(),b=F||R,c=te(se,n),C=c.currentTabStopId===b,$=M(n),{onFocusableItemAdd:m,onFocusableItemRemove:p}=c;return O(()=>{if(t)return m(),()=>p()},[t,m,p]),i(w.ItemSlot,{scope:n,id:b,focusable:t,active:v},i(N.span,_({tabIndex:C?0:-1,"data-orientation":c.orientation},g,{ref:o,onMouseDown:l(e.onMouseDown,s=>{t?c.onItemFocus(b):s.preventDefault()}),onFocus:l(e.onFocus,()=>c.onItemFocus(b)),onKeyDown:l(e.onKeyDown,s=>{if(s.key==="Tab"&&s.shiftKey){c.onItemShiftTab();return}if(s.target!==s.currentTarget)return;let u=ue(s,c.orientation,c.dir);if(u!==void 0){s.preventDefault();let a=$().filter(f=>f.focusable).map(f=>f.ref.current);if(u==="last")a.reverse();else if(u==="prev"||u==="next"){u==="prev"&&a.reverse();let f=a.indexOf(s.currentTarget);a=c.loop?de(a,f+1):a.slice(f+1)}setTimeout(()=>L(a))}})})))}),ae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function fe(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ue(e,o,n){let t=fe(e.key,n);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return ae[t]}function L(e){let o=document.activeElement;for(let n of e)if(n===o||(n.focus(),document.activeElement!==o))return}function de(e,o){return e.map((n,t)=>e[(o+t)%e.length])}var Se=re,ye=ce;export{ye as Item,Se as Root,re as RovingFocusGroup,ce as RovingFocusGroupItem,Ee as createRovingFocusGroupScope};
//# sourceMappingURL=react-roving-focus.mjs.map