/* esm.sh - esbuild bundle(@radix-ui/react-presence@1.0.1) denonext production */
import{Children as q,cloneElement as p,useState as v,useRef as l,useEffect as E,useCallback as h,useReducer as M}from"../../../../../../esm.sh/preact@10.19.6/compat.js";
import{flushSync as O}from"../../../../../../esm.sh/preact@10.19.6/compat.js";
import{useComposedRefs as T}from"../../../../../../esm.sh/v132/_@radix-ui/react-compose-refs@1.0.1.js";
import{useLayoutEffect as A}from"../../../../../../esm.sh/v132/_@radix-ui/react-use-layout-effect@1.0.1.js";
function S(n,t){return M((o,r)=>{let i=t[o][r];return i??o},n)}var U=n=>{let{present:t,children:o}=n,r=y(t),i=typeof o=="function"?o({present:r.isPresent}):q.only(o),a=T(r.ref,i.ref);return typeof o=="function"||r.isPresent?p(i,{ref:a}):null};U.displayName="Presence";function y(n){let[t,o]=v(),r=l({}),i=l(n),a=l("none"),N=n?"mounted":"unmounted",[f,s]=S(N,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E(()=>{let e=d(r.current);a.current=f==="mounted"?e:"none"},[f]),A(()=>{let e=r.current,u=i.current;if(u!==n){let $=a.current,m=d(e);n?s("MOUNT"):m==="none"||e?.display==="none"?s("UNMOUNT"):s(u&&$!==m?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,s]),A(()=>{if(t){let e=c=>{let m=d(r.current).includes(c.animationName);c.target===t&&m&&O(()=>s("ANIMATION_END"))},u=c=>{c.target===t&&(a.current=d(r.current))};return t.addEventListener("animationstart",u),t.addEventListener("animationcancel",e),t.addEventListener("animationend",e),()=>{t.removeEventListener("animationstart",u),t.removeEventListener("animationcancel",e),t.removeEventListener("animationend",e)}}else s("ANIMATION_END")},[t,s]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:h(e=>{e&&(r.current=getComputedStyle(e)),o(e)},[])}}function d(n){return n?.animationName||"none"}export{U as Presence};
//# sourceMappingURL=react-presence.mjs.map